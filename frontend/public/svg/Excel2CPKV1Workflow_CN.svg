<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#7C2D12;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#C2410C;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F3F4F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E5E7EB;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="600" fill="#FAFAFA"/>
  
  <!-- Header -->
  <rect x="0" y="0" width="800" height="80" fill="url(#headerGradient)"/>
  <text x="400" y="50" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="24" font-weight="bold">
    Excel转CPK V1 - 工作流程
  </text>
  
  <!-- Step 1: Upload -->
  <g transform="translate(50, 120)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">1. 上传Excel</text>
    <rect x="20" y="35" width="110" height="50" rx="5" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1"/>
    <text x="75" y="55" text-anchor="middle" fill="#92400E" font-family="Arial, sans-serif" font-size="10">Excel文件</text>
    <text x="75" y="70" text-anchor="middle" fill="#92400E" font-family="Arial, sans-serif" font-size="10">(规格+数据)</text>
  </g>
  
  <!-- Arrow 1 -->
  <path d="M 220 170 L 280 170" stroke="#6B7280" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Step 2: Checkpoint 1 -->
  <g transform="translate(300, 120)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">2. 检查点1</text>
    <rect x="20" y="35" width="110" height="50" rx="5" fill="#DBEAFE" stroke="#3B82F6" stroke-width="1"/>
    <text x="75" y="50" text-anchor="middle" fill="#1E40AF" font-family="Arial, sans-serif" font-size="9">Excel结构</text>
    <text x="75" y="65" text-anchor="middle" fill="#1E40AF" font-family="Arial, sans-serif" font-size="9">验证</text>
    <text x="75" y="80" text-anchor="middle" fill="#1E40AF" font-family="Arial, sans-serif" font-size="9">工作表检测</text>
  </g>
  
  <!-- Arrow 2 -->
  <path d="M 470 170 L 530 170" stroke="#6B7280" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Step 3: Checkpoint 2 -->
  <g transform="translate(550, 120)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">3. 检查点2</text>
    <rect x="20" y="35" width="110" height="50" rx="5" fill="#D1FAE5" stroke="#10B981" stroke-width="1"/>
    <text x="75" y="50" text-anchor="middle" fill="#065F46" font-family="Arial, sans-serif" font-size="9">规格数据</text>
    <text x="75" y="65" text-anchor="middle" fill="#065F46" font-family="Arial, sans-serif" font-size="9">一致性</text>
    <text x="75" y="80" text-anchor="middle" fill="#065F46" font-family="Arial, sans-serif" font-size="9">验证</text>
  </g>
  
  <!-- Arrow 3 -->
  <path d="M 400 250 L 400 290" stroke="#6B7280" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Step 4: Checkpoint 3 -->
  <g transform="translate(300, 310)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">4. 检查点3</text>
    <rect x="20" y="35" width="110" height="50" rx="5" fill="#F3E8FF" stroke="#8B5CF6" stroke-width="1"/>
    <text x="75" y="50" text-anchor="middle" fill="#6B21A8" font-family="Arial, sans-serif" font-size="9">数据匹配</text>
    <text x="75" y="65" text-anchor="middle" fill="#6B21A8" font-family="Arial, sans-serif" font-size="9">工作表间</text>
    <text x="75" y="80" text-anchor="middle" fill="#6B21A8" font-family="Arial, sans-serif" font-size="9">验证</text>
  </g>
  
  <!-- Arrow 4 -->
  <path d="M 220 360 L 280 360" stroke="#6B7280" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Step 5: Generate Files -->
  <g transform="translate(50, 310)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">5. 生成文件</text>
    <rect x="20" y="35" width="50" height="50" rx="5" fill="#FEF2F2" stroke="#EF4444" stroke-width="1"/>
    <text x="45" y="55" text-anchor="middle" fill="#991B1B" font-family="Arial, sans-serif" font-size="9">CSV</text>
    <rect x="80" y="35" width="50" height="50" rx="5" fill="#FEF2F2" stroke="#EF4444" stroke-width="1"/>
    <text x="105" y="55" text-anchor="middle" fill="#991B1B" font-family="Arial, sans-serif" font-size="9">JSL</text>
  </g>
  
  <!-- Arrow 5 -->
  <path d="M 470 360 L 530 360" stroke="#6B7280" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Step 6: CPK Analysis -->
  <g transform="translate(550, 310)">
    <rect x="0" y="0" width="150" height="100" rx="10" fill="url(#stepGradient)" stroke="#D1D5DB" stroke-width="2" filter="url(#shadow)"/>
    <text x="75" y="25" text-anchor="middle" fill="#374151" font-family="Arial, sans-serif" font-size="14" font-weight="bold">6. CPK分析</text>
    <rect x="20" y="35" width="110" height="50" rx="5" fill="#F0FDF4" stroke="#22C55E" stroke-width="1"/>
    <text x="75" y="50" text-anchor="middle" fill="#166534" font-family="Arial, sans-serif" font-size="9">过程</text>
    <text x="75" y="65" text-anchor="middle" fill="#166534" font-family="Arial, sans-serif" font-size="9">能力</text>
    <text x="75" y="80" text-anchor="middle" fill="#166534" font-family="Arial, sans-serif" font-size="9">报告</text>
  </g>
  
  <!-- Excel Structure Diagram -->
  <g transform="translate(50, 450)">
    <text x="0" y="0" fill="#374151" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Excel文件结构：</text>
    
    <!-- Spec Sheet -->
    <g transform="translate(0, 20)">
      <rect x="0" y="0" width="180" height="120" rx="5" fill="#F9FAFB" stroke="#D1D5DB" stroke-width="1"/>
      <text x="10" y="20" fill="#374151" font-family="Arial, sans-serif" font-size="12" font-weight="bold">规格表</text>
      <text x="10" y="40" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• test_name</text>
      <text x="10" y="55" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• usl</text>
      <text x="10" y="70" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• lsl</text>
      <text x="10" y="85" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• target</text>
      <text x="10" y="100" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• 其他列</text>
      <text x="10" y="115" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• （可选）</text>
    </g>
    
    <!-- Meta Sheet Alternative -->
    <g transform="translate(200, 20)">
      <rect x="0" y="0" width="180" height="120" rx="5" fill="#F9FAFB" stroke="#D1D5DB" stroke-width="1"/>
      <text x="10" y="20" fill="#374151" font-family="Arial, sans-serif" font-size="12" font-weight="bold">元数据表（备选）</text>
      <text x="10" y="40" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• Y Variable</text>
      <text x="10" y="55" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• USL</text>
      <text x="10" y="70" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• LSL</text>
      <text x="10" y="85" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• Target</text>
      <text x="10" y="100" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• 其他列</text>
      <text x="10" y="115" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• （可选）</text>
    </g>
    
    <!-- Data Sheet -->
    <g transform="translate(400, 20)">
      <rect x="0" y="0" width="180" height="120" rx="5" fill="#F9FAFB" stroke="#D1D5DB" stroke-width="1"/>
      <text x="10" y="20" fill="#374151" font-family="Arial, sans-serif" font-size="12" font-weight="bold">数据表</text>
      <text x="10" y="40" fill="#7C2D12" font-family="Arial, sans-serif" font-size="10" font-weight="bold">• FAI1, FAI2, FAI3...</text>
      <text x="10" y="55" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• 其他列</text>
      <text x="10" y="70" fill="#6B7280" font-family="Arial, sans-serif" font-size="10">• （可选）</text>
      <text x="10" y="85" fill="#059669" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✓ 测试名称必须</text>
      <text x="10" y="100" fill="#059669" font-family="Arial, sans-serif" font-size="10" font-weight="bold">匹配FAI列</text>
      <text x="10" y="115" fill="#059669" font-family="Arial, sans-serif" font-size="10" font-weight="bold">在工作表间</text>
    </g>
    
    <!-- Auto-Mapping -->
    <g transform="translate(600, 20)">
      <rect x="0" y="0" width="180" height="120" rx="5" fill="#F0F9FF" stroke="#0EA5E9" stroke-width="1"/>
      <text x="10" y="20" fill="#374151" font-family="Arial, sans-serif" font-size="12" font-weight="bold">自动映射</text>
      <text x="10" y="40" fill="#0369A1" font-family="Arial, sans-serif" font-size="10">Y Variable → test_name</text>
      <text x="10" y="55" fill="#0369A1" font-family="Arial, sans-serif" font-size="10">USL → usl</text>
      <text x="10" y="70" fill="#0369A1" font-family="Arial, sans-serif" font-size="10">LSL → lsl</text>
      <text x="10" y="85" fill="#0369A1" font-family="Arial, sans-serif" font-size="10">Target → target</text>
      <text x="10" y="100" fill="#059669" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✓ 支持规格</text>
      <text x="10" y="115" fill="#059669" font-family="Arial, sans-serif" font-size="10" font-weight="bold">和元数据格式</text>
    </g>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6B7280"/>
    </marker>
  </defs>
</svg>
